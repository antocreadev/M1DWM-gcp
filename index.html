<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Test FastAPI</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-gray-100 font-sans">
    <div class="container mx-auto p-8">
      <header class="text-center mb-6">
        <h1 class="text-4xl font-semibold text-blue-600">
          Bienvenue sur FastAPI !
        </h1>
        <p class="text-lg text-gray-700">
          Interagissez avec l'API et explorez les fonctionnalités.
        </p>
      </header>

      <div class="space-y-4">
        <!-- Boutons pour tester les points de terminaison -->
        <div class="flex justify-center space-x-4">
          <button
            onclick="fetchRoot()"
            class="bg-blue-500 text-white py-2 px-4 rounded-lg shadow-md hover:bg-blue-600 transition"
          >
            Appeler /
          </button>
          <button
            onclick="fetchTestDb()"
            class="bg-green-500 text-white py-2 px-4 rounded-lg shadow-md hover:bg-green-600 transition"
          >
            Tester la base de données
          </button>
          <button
            onclick="fetchAddUser()"
            class="bg-purple-500 text-white py-2 px-4 rounded-lg shadow-md hover:bg-purple-600 transition"
          >
            Ajouter un utilisateur
          </button>
        </div>

        <!-- Affichage de la réponse -->
        <div class="text-center mt-6">
          <p id="response" class="text-xl font-medium text-gray-800"></p>
        </div>
      </div>
    </div>

    <script>
      async function fetchRoot() {
        const response = await fetch(
          "https://fastapi-api-938655321883.us-central1.run.app/"
        );
        const data = await response.json();
        document.getElementById("response").innerText = data.message;
      }

      async function fetchTestDb() {
        const response = await fetch(
          "https://fastapi-api-938655321883.us-central1.run.app/test-db"
        );
        const data = await response.json();
        document.getElementById(
          "response"
        ).innerText = `Temps DB: ${data.db_time}`;
      }

      async function fetchAddUser() {
        const name = prompt("Entrez le nom de l'utilisateur");
        const age = prompt("Entrez l'âge de l'utilisateur");
        if (name && age) {
          const response = await fetch(
            `https://fastapi-api-938655321883.us-central1.run.app/add-user/${name}/${age}`
          );
          const data = await response.json();
          document.getElementById("response").innerText = data.message;
        } else {
          document.getElementById("response").innerText =
            "Nom et âge sont requis.";
        }
      }
    </script>
  </body>
</html>
